!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):e.Mark=t(e.jQuery)}(this,(function(e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},o=function(){function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5e3;a(this,e),this.ctx=t,this.iframes=n,this.exclude=i,this.iframesTimeout=o}return n(e,[{key:"getContexts",value:function(){var e=[];return(void 0!==this.ctx&&this.ctx?NodeList.prototype.isPrototypeOf(this.ctx)?Array.prototype.slice.call(this.ctx):Array.isArray(this.ctx)?this.ctx:"string"==typeof this.ctx?Array.prototype.slice.call(document.querySelectorAll(this.ctx)):[this.ctx]:[]).forEach((function(t){var a=e.filter((function(e){return e.contains(t)})).length>0;-1!==e.indexOf(t)||a||e.push(t)})),e}},{key:"getIframeContents",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},n=void 0;try{var i=e.contentWindow;if(n=i.document,!i||!n)throw new Error("iframe inaccessible")}catch(e){a()}n&&t(n)}},{key:"isIframeBlank",value:function(e){var t="about:blank",a=e.getAttribute("src").trim();return e.contentWindow.location.href===t&&a!==t&&a}},{key:"observeIframeLoad",value:function(e,t,a){var n=this,i=!1,o=null,s=function s(){if(!i){i=!0,clearTimeout(o);try{n.isIframeBlank(e)||(e.removeEventListener("load",s),n.getIframeContents(e,t,a))}catch(e){a()}}};e.addEventListener("load",s),o=setTimeout(s,this.iframesTimeout)}},{key:"onIframeReady",value:function(e,t,a){try{"complete"===e.contentWindow.document.readyState?this.isIframeBlank(e)?this.observeIframeLoad(e,t,a):this.getIframeContents(e,t,a):this.observeIframeLoad(e,t,a)}catch(e){a()}}},{key:"waitForIframes",value:function(e,t){var a=this,n=0;this.forEachIframe(e,(function(){return!0}),(function(e){n++,a.waitForIframes(e.querySelector("html"),(function(){--n||t()}))}),(function(e){e||t()}))}},{key:"forEachIframe",value:function(t,a,n){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},s=t.querySelectorAll("iframe"),r=s.length,l=0;s=Array.prototype.slice.call(s);var c=function(){--r<=0&&o(l)};r||c(),s.forEach((function(t){e.matches(t,i.exclude)?c():i.onIframeReady(t,(function(e){a(t)&&(l++,n(e)),c()}),c)}))}},{key:"createIterator",value:function(e,t,a){return document.createNodeIterator(e,t,a,!1)}},{key:"createInstanceOnIframe",value:function(t){return new e(t.querySelector("html"),this.iframes)}},{key:"compareNodeIframe",value:function(e,t,a){if(e.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_PRECEDING){if(null===t)return!0;if(t.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_FOLLOWING)return!0}return!1}},{key:"getIteratorNode",value:function(e){var t=e.previousNode();return{prevNode:t,node:(null===t||e.nextNode())&&e.nextNode()}}},{key:"checkIframeFilter",value:function(e,t,a,n){var i=!1,o=!1;return n.forEach((function(e,t){e.val===a&&(i=t,o=e.handled)})),this.compareNodeIframe(e,t,a)?(!1!==i||o?!1===i||o||(n[i].handled=!0):n.push({val:a,handled:!0}),!0):(!1===i&&n.push({val:a,handled:!1}),!1)}},{key:"handleOpenIframes",value:function(e,t,a,n){var i=this;e.forEach((function(e){e.handled||i.getIframeContents(e.val,(function(e){i.createInstanceOnIframe(e).forEachNode(t,a,n)}))}))}},{key:"iterateThroughNodes",value:function(e,t,a,n,i){for(var o,s=this,r=this.createIterator(t,e,n),l=[],c=[],d=void 0,u=void 0;o=void 0,o=s.getIteratorNode(r),u=o.prevNode,d=o.node;)this.iframes&&this.forEachIframe(t,(function(e){return s.checkIframeFilter(d,u,e,l)}),(function(t){s.createInstanceOnIframe(t).forEachNode(e,(function(e){return c.push(e)}),n)})),c.push(d);c.forEach((function(e){a(e)})),this.iframes&&this.handleOpenIframes(l,e,a,n),i()}},{key:"forEachNode",value:function(e,t,a){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},o=this.getContexts(),s=o.length;s||i(),o.forEach((function(o){var r=function(){n.iterateThroughNodes(e,o,t,a,(function(){--s<=0&&i()}))};n.iframes?n.waitForIframes(o,r):r()}))}}],[{key:"matches",value:function(e,t){var a="string"==typeof t?[t]:t,n=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;if(n){var i=!1;return a.every((function(t){return!n.call(e,t)||(i=!0,!1)})),i}return!1}}]),e}(),s=function(){function e(t){a(this,e),this.ctx=t,this.ie=!1;var n=window.navigator.userAgent;(n.indexOf("MSIE")>-1||n.indexOf("Trident")>-1)&&(this.ie=!0)}return n(e,[{key:"log",value:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"debug",n=this.opt.log;this.opt.debug&&"object"===(void 0===n?"undefined":t(n))&&"function"==typeof n[a]&&n[a]("mark.js: "+e)}},{key:"escapeStr",value:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}},{key:"createRegExp",value:function(e){return"disabled"!==this.opt.wildcards&&(e=this.setupWildcardsRegExp(e)),e=this.escapeStr(e),Object.keys(this.opt.synonyms).length&&(e=this.createSynonymsRegExp(e)),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.setupIgnoreJoinersRegExp(e)),this.opt.diacritics&&(e=this.createDiacriticsRegExp(e)),e=this.createMergedBlanksRegExp(e),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.createJoinersRegExp(e)),"disabled"!==this.opt.wildcards&&(e=this.createWildcardsRegExp(e)),e=this.createAccuracyRegExp(e)}},{key:"createSynonymsRegExp",value:function(e){var t=this.opt.synonyms,a=this.opt.caseSensitive?"":"i",n=this.opt.ignoreJoiners||this.opt.ignorePunctuation.length?"\0":"";for(var i in t)if(t.hasOwnProperty(i)){var o=t[i],s="disabled"!==this.opt.wildcards?this.setupWildcardsRegExp(i):this.escapeStr(i),r="disabled"!==this.opt.wildcards?this.setupWildcardsRegExp(o):this.escapeStr(o);""!==s&&""!==r&&(e=e.replace(new RegExp("("+this.escapeStr(s)+"|"+this.escapeStr(r)+")","gm"+a),n+"("+this.processSynomyms(s)+"|"+this.processSynomyms(r)+")"+n))}return e}},{key:"processSynomyms",value:function(e){return(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.setupIgnoreJoinersRegExp(e)),e}},{key:"setupWildcardsRegExp",value:function(e){return(e=e.replace(/(?:\\)*\?/g,(function(e){return"\\"===e.charAt(0)?"?":""}))).replace(/(?:\\)*\*/g,(function(e){return"\\"===e.charAt(0)?"*":""}))}},{key:"createWildcardsRegExp",value:function(e){var t="withSpaces"===this.opt.wildcards;return e.replace(/\u0001/g,t?"[\\S\\s]?":"\\S?").replace(/\u0002/g,t?"[\\S\\s]*?":"\\S*")}},{key:"setupIgnoreJoinersRegExp",value:function(e){return e.replace(/[^(|)\\]/g,(function(e,t,a){var n=a.charAt(t+1);return/[(|)\\]/.test(n)||""===n?e:e+"\0"}))}},{key:"createJoinersRegExp",value:function(e){var t=[],a=this.opt.ignorePunctuation;return Array.isArray(a)&&a.length&&t.push(this.escapeStr(a.join(""))),this.opt.ignoreJoiners&&t.push("\\u00ad\\u200b\\u200c\\u200d"),t.length?e.split(/\u0000+/).join("["+t.join("")+"]*"):e}},{key:"createDiacriticsRegExp",value:function(e){var t=this.opt.caseSensitive?"":"i",a=this.opt.caseSensitive?["aàáảãạăằắẳẵặâầấẩẫậäåāą","AÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćč","CÇĆČ","dđď","DĐĎ","eèéẻẽẹêềếểễệëěēę","EÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïī","IÌÍỈĨỊÎÏĪ","lł","LŁ","nñňń","NÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøō","OÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rř","RŘ","sšśșş","SŠŚȘŞ","tťțţ","TŤȚŢ","uùúủũụưừứửữựûüůū","UÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿ","YÝỲỶỸỴŸ","zžżź","ZŽŻŹ"]:["aàáảãạăằắẳẵặâầấẩẫậäåāąAÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćčCÇĆČ","dđďDĐĎ","eèéẻẽẹêềếểễệëěēęEÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïīIÌÍỈĨỊÎÏĪ","lłLŁ","nñňńNÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøōOÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rřRŘ","sšśșşSŠŚȘŞ","tťțţTŤȚŢ","uùúủũụưừứửữựûüůūUÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿYÝỲỶỸỴŸ","zžżźZŽŻŹ"],n=[];return e.split("").forEach((function(i){a.every((function(a){if(-1!==a.indexOf(i)){if(n.indexOf(a)>-1)return!1;e=e.replace(new RegExp("["+a+"]","gm"+t),"["+a+"]"),n.push(a)}return!0}))})),e}},{key:"createMergedBlanksRegExp",value:function(e){return e.replace(/[\s]+/gim,"[\\s]+")}},{key:"createAccuracyRegExp",value:function(e){var t=this,a=this.opt.accuracy,n="string"==typeof a?a:a.value,i="string"==typeof a?[]:a.limiters,o="";switch(i.forEach((function(e){o+="|"+t.escapeStr(e)})),n){case"partially":default:return"()("+e+")";case"complementary":return"()([^"+(o="\\s"+(o||this.escapeStr("!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~¡¿")))+"]*"+e+"[^"+o+"]*)";case"exactly":return"(^|\\s"+o+")("+e+")(?=$|\\s"+o+")"}}},{key:"getSeparatedKeywords",value:function(e){var t=this,a=[];return e.forEach((function(e){t.opt.separateWordSearch?e.split(" ").forEach((function(e){e.trim()&&-1===a.indexOf(e)&&a.push(e)})):e.trim()&&-1===a.indexOf(e)&&a.push(e)})),{keywords:a.sort((function(e,t){return t.length-e.length})),length:a.length}}},{key:"isNumeric",value:function(e){return Number(parseFloat(e))==e}},{key:"checkRanges",value:function(e){var t=this;if(!Array.isArray(e)||"[object Object]"!==Object.prototype.toString.call(e[0]))return this.log("markRanges() will only accept an array of objects"),this.opt.noMatch(e),[];var a=[],n=0;return e.sort((function(e,t){return e.start-t.start})).forEach((function(e){var i=t.callNoMatchOnInvalidRanges(e,n),o=i.start,s=i.end;i.valid&&(e.start=o,e.length=s-o,a.push(e),n=s)})),a}},{key:"callNoMatchOnInvalidRanges",value:function(e,t){var a=void 0,n=void 0,i=!1;return e&&void 0!==e.start?(n=(a=parseInt(e.start,10))+parseInt(e.length,10),this.isNumeric(e.start)&&this.isNumeric(e.length)&&n-t>0&&n-a>0?i=!0:(this.log("Ignoring invalid or overlapping range: "+JSON.stringify(e)),this.opt.noMatch(e))):(this.log("Ignoring invalid range: "+JSON.stringify(e)),this.opt.noMatch(e)),{start:a,end:n,valid:i}}},{key:"checkWhitespaceRanges",value:function(e,t,a){var n=void 0,i=!0,o=a.length,s=t-o,r=parseInt(e.start,10)-s;return(n=(r=r>o?o:r)+parseInt(e.length,10))>o&&(n=o,this.log("End range automatically set to the max value of "+o)),r<0||n-r<0||r>o||n>o?(i=!1,this.log("Invalid range: "+JSON.stringify(e)),this.opt.noMatch(e)):""===a.substring(r,n).replace(/\s+/g,"")&&(i=!1,this.log("Skipping whitespace only range: "+JSON.stringify(e)),this.opt.noMatch(e)),{start:r,end:n,valid:i}}},{key:"getTextNodes",value:function(e){var t=this,a="",n=[];this.iterator.forEachNode(NodeFilter.SHOW_TEXT,(function(e){n.push({start:a.length,end:(a+=e.textContent).length,node:e})}),(function(e){return t.matchesExclude(e.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}),(function(){e({value:a,nodes:n})}))}},{key:"matchesExclude",value:function(e){return o.matches(e,this.opt.exclude.concat(["script","style","title","head","html"]))}},{key:"wrapRangeInTextNode",value:function(e,t,a){var n=this.opt.element?this.opt.element:"mark",i=e.splitText(t),o=i.splitText(a-t),s=document.createElement(n);return s.setAttribute("data-markjs","true"),this.opt.className&&s.setAttribute("class",this.opt.className),s.textContent=i.textContent,i.parentNode.replaceChild(s,i),o}},{key:"wrapRangeInMappedTextNode",value:function(e,t,a,n,i){var o=this;e.nodes.every((function(s,r){var l=e.nodes[r+1];if(void 0===l||l.start>t){if(!n(s.node))return!1;var c=t-s.start,d=(a>s.end?s.end:a)-s.start,u=e.value.substr(0,s.start),p=e.value.substr(d+s.start);if(s.node=o.wrapRangeInTextNode(s.node,c,d),e.value=u+p,e.nodes.forEach((function(t,a){a>=r&&(e.nodes[a].start>0&&a!==r&&(e.nodes[a].start-=d),e.nodes[a].end-=d)})),a-=d,i(s.node.previousSibling,s.start),!(a>s.end))return!1;t=s.end}return!0}))}},{key:"wrapMatches",value:function(e,t,a,n,i){var o=this,s=0===t?0:t+1;this.getTextNodes((function(t){t.nodes.forEach((function(t){t=t.node;for(var i=void 0;null!==(i=e.exec(t.textContent))&&""!==i[s];)if(a(i[s],t)){var r=i.index;if(0!==s)for(var l=1;l<s;l++)r+=i[l].length;t=o.wrapRangeInTextNode(t,r,r+i[s].length),n(t.previousSibling),e.lastIndex=0}})),i()}))}},{key:"wrapMatchesAcrossElements",value:function(e,t,a,n,i){var o=this,s=0===t?0:t+1;this.getTextNodes((function(t){for(var r=void 0;null!==(r=e.exec(t.value))&&""!==r[s];){var l=r.index;if(0!==s)for(var c=1;c<s;c++)l+=r[c].length;var d=l+r[s].length;o.wrapRangeInMappedTextNode(t,l,d,(function(e){return a(r[s],e)}),(function(t,a){e.lastIndex=a,n(t)}))}i()}))}},{key:"wrapRangeFromIndex",value:function(e,t,a,n){var i=this;this.getTextNodes((function(o){var s=o.value.length;e.forEach((function(e,n){var r=i.checkWhitespaceRanges(e,s,o.value),l=r.start,c=r.end;r.valid&&i.wrapRangeInMappedTextNode(o,l,c,(function(a){return t(a,e,o.value.substring(l,c),n)}),(function(t){a(t,e)}))})),n()}))}},{key:"unwrapMatches",value:function(e){for(var t=e.parentNode,a=document.createDocumentFragment();e.firstChild;)a.appendChild(e.removeChild(e.firstChild));t.replaceChild(a,e),this.ie?this.normalizeTextNode(t):t.normalize()}},{key:"normalizeTextNode",value:function(e){if(e){if(3===e.nodeType)for(;e.nextSibling&&3===e.nextSibling.nodeType;)e.nodeValue+=e.nextSibling.nodeValue,e.parentNode.removeChild(e.nextSibling);else this.normalizeTextNode(e.firstChild);this.normalizeTextNode(e.nextSibling)}}},{key:"markRegExp",value:function(e,t){var a=this;this.opt=t,this.log('Searching with expression "'+e+'"');var n=0,i="wrapMatches";this.opt.acrossElements&&(i="wrapMatchesAcrossElements"),this[i](e,this.opt.ignoreGroups,(function(e,t){return a.opt.filter(t,e,n)}),(function(e){n++,a.opt.each(e)}),(function(){0===n&&a.opt.noMatch(e),a.opt.done(n)}))}},{key:"mark",value:function(e,t){var a=this;this.opt=t;var n=0,i="wrapMatches",o=this.getSeparatedKeywords("string"==typeof e?[e]:e),s=o.keywords,r=o.length,l=this.opt.caseSensitive?"":"i";this.opt.acrossElements&&(i="wrapMatchesAcrossElements"),0===r?this.opt.done(n):function e(t){var o=new RegExp(a.createRegExp(t),"gm"+l),c=0;a.log('Searching with expression "'+o+'"'),a[i](o,1,(function(e,i){return a.opt.filter(i,t,n,c)}),(function(e){c++,n++,a.opt.each(e)}),(function(){0===c&&a.opt.noMatch(t),s[r-1]===t?a.opt.done(n):e(s[s.indexOf(t)+1])}))}(s[0])}},{key:"markRanges",value:function(e,t){var a=this;this.opt=t;var n=0,i=this.checkRanges(e);i&&i.length?(this.log("Starting to mark with the following ranges: "+JSON.stringify(i)),this.wrapRangeFromIndex(i,(function(e,t,n,i){return a.opt.filter(e,t,n,i)}),(function(e,t){n++,a.opt.each(e,t)}),(function(){a.opt.done(n)}))):this.opt.done(n)}},{key:"unmark",value:function(e){var t=this;this.opt=e;var a=this.opt.element?this.opt.element:"*";a+="[data-markjs]",this.opt.className&&(a+="."+this.opt.className),this.log('Removal selector "'+a+'"'),this.iterator.forEachNode(NodeFilter.SHOW_ELEMENT,(function(e){t.unwrapMatches(e)}),(function(e){var n=o.matches(e,a),i=t.matchesExclude(e);return!n||i?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}),this.opt.done)}},{key:"opt",set:function(e){this._opt=i({},{element:"",className:"",exclude:[],iframes:!1,iframesTimeout:5e3,separateWordSearch:!0,diacritics:!0,synonyms:{},accuracy:"partially",acrossElements:!1,caseSensitive:!1,ignoreJoiners:!1,ignoreGroups:0,ignorePunctuation:[],wildcards:"disabled",each:function(){},noMatch:function(){},filter:function(){return!0},done:function(){},debug:!1,log:window.console},e)},get:function(){return this._opt}},{key:"iterator",get:function(){return new o(this.ctx,this.opt.iframes,this.opt.exclude,this.opt.iframesTimeout)}}]),e}();return e.fn.mark=function(e,t){return new s(this.get()).mark(e,t),this},e.fn.markRegExp=function(e,t){return new s(this.get()).markRegExp(e,t),this},e.fn.markRanges=function(e,t){return new s(this.get()).markRanges(e,t),this},e.fn.unmark=function(e){return new s(this.get()).unmark(e),this},e})),function(e){"use strict";var t='[data-toggle="tsml-dropdown"]',a=function(t){e(t).on("click.bs.dropdown",this.toggle)};function n(t){var a=t.attr("data-target");a||(a=(a=t.attr("href"))&&/#[A-Za-z]/.test(a)&&a.replace(/.*(?=#[^\s]*$)/,""));var n=a&&e(a);return n&&n.length?n:t.parent()}function i(a){a&&3===a.which||(e(".dropdown-backdrop").remove(),e(t).each((function(){var t=e(this),i=n(t),o={relatedTarget:this};i.hasClass("open")&&(a&&"click"==a.type&&/input|textarea/i.test(a.target.tagName)&&e.contains(i[0],a.target)||(i.trigger(a=e.Event("hide.bs.dropdown",o)),a.isDefaultPrevented()||(t.attr("aria-expanded","false"),i.removeClass("open").trigger(e.Event("hidden.bs.dropdown",o)))))})))}a.VERSION="3.3.7",a.prototype.toggle=function(t){var a=e(this);if(!a.is(".disabled, :disabled")){var o=n(a),s=o.hasClass("open");if(i(),!s){"ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&e(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(e(this)).on("click",i);var r={relatedTarget:this};if(o.trigger(t=e.Event("show.bs.dropdown",r)),t.isDefaultPrevented())return;a.trigger("focus").attr("aria-expanded","true"),o.toggleClass("open").trigger(e.Event("shown.bs.dropdown",r))}return!1}},a.prototype.keydown=function(a){if(/(38|40|27|32)/.test(a.which)&&!/input|textarea/i.test(a.target.tagName)){var i=e(this);if(a.preventDefault(),a.stopPropagation(),!i.is(".disabled, :disabled")){var o=n(i),s=o.hasClass("open");if(!s&&27!=a.which||s&&27==a.which)return 27==a.which&&o.find(t).trigger("focus"),i.trigger("click");var r=o.find(".dropdown-menu li:not(.disabled):visible a");if(r.length){var l=r.index(a.target);38==a.which&&l>0&&l--,40==a.which&&l<r.length-1&&l++,~l||(l=0),r.eq(l).trigger("focus")}}}};var o=e.fn.dropdown;e.fn.dropdown=function(t){return this.each((function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new a(this)),"string"==typeof t&&i[t].call(n)}))},e.fn.dropdown.Constructor=a,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=o,this},e(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".dropdown form",(function(e){e.stopPropagation()})).on("click.bs.dropdown.data-api",t,a.prototype.toggle).on("keydown.bs.dropdown.data-api",t,a.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",a.prototype.keydown)}(jQuery);var infowindow,searchLocation,searchMarker,tsmlmap,bounds,locationIcon,searchIcon,markers=[];function createMap(e,t,a){tsml.debug&&console.log("createMap() locations",t),tsmlmap||(tsmlmap=L.map("map"),L.tileLayer("https://{s}s.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",{maxZoom:19,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="https://carto.com/attributions">CARTO</a>'}).addTo(tsmlmap)),bounds={north:!1,south:!1,east:!1,west:!1},locationIcon=window.btoa('<?xml version="1.0" encoding="utf-8"?><svg viewBox="-1.1 -1.086 43.182 63.273" xmlns="http://www.w3.org/2000/svg"><path fill="#f76458" stroke="#b3382c" stroke-width="3" d="M20.5,0.5 c11.046,0,20,8.656,20,19.333c0,10.677-12.059,21.939-20,38.667c-5.619-14.433-20-27.989-20-38.667C0.5,9.156,9.454,0.5,20.5,0.5z"/></svg>'),searchIcon=window.btoa('<?xml version="1.0" encoding="utf-8"?><svg viewBox="-1.1 -1.086 43.182 63.273" xmlns="http://www.w3.org/2000/svg"><path fill="#2c78b3" stroke="#2c52b3" stroke-width="3" d="M20.5,0.5 c11.046,0,20,8.656,20,19.333c0,10.677-12.059,21.939-20,38.667c-5.619-14.433-20-27.989-20-38.667C0.5,9.156,9.454,0.5,20.5,0.5z"/></svg>'),setMapMarkers(t,a)}function formatAddress(e,t){if(!e)return"";if(e=e.split(", "),t)return e[0];if("USA"==e[e.length-1]){e.pop();var a=e.pop();e[e.length-1]+=", "+a}return e.join("<br>")}function formatLink(e,t,a){if(!e)return t;if(location.search){for(var n=location.search.substr(1).split("&"),i=[],o=0;o<n.length;o++){var s=n[o].split("=");s[0]!=a&&(i[i.length]=s[0]+"="+s[1])}i.length&&(e+=(-1==e.indexOf("?")?"?":"&")+i.join("&"))}return'<a href="'+e+'">'+t+"</a>"}function removeSearchMarker(){searchLocation=null,"object"==typeof searchMarker&&searchMarker&&(searchMarker.setMap(null),searchMarker=null)}function setMapBounds(){markers.length>1?tsmlmap.fitBounds([[bounds.south,bounds.west],[bounds.north,bounds.east]],{padding:[10,10]}):1==markers.length&&(markers[0].getPopup()?(tsmlmap.setZoom(16),tsmlmap.panTo([bounds.north+.0025,bounds.east]),markers[0].togglePopup()):(tsmlmap.setZoom(16),tsmlmap.panTo([bounds.north,bounds.east])))}function setMapMarker(e,t,a){if(t.lat||t.lng){var n,i=document.createElement("div");i.className="marker",i.style.backgroundImage="url(data:image/svg+xml;base64,"+locationIcon+")",i.style.width="26px",i.style.height="38.4px";var o=L.divIcon({className:"marker",html:i,iconAnchor:[13,38.4],popupAnchor:[0,-22]});if(n=new L.marker(t,{icon:o}).addTo(tsmlmap),a){var s=new L.popup;s.setContent(a),n.bindPopup(s)}return n.addTo(tsmlmap),n}}function setMapMarkers(e,t){if(markers.length){for(var a=0;a<markers.length;a++)markers[a].remove();markers=[]}removeSearchMarker(),t&&(tsml.debug&&console.log("setMapMarker() searchLocation",t),setSearchMarker(t));var n="object"==typeof e?Object.keys(e).map((function(t){return e[t]})).sort((function(e,t){return t.latitude-e.latitude})):[];for(a=0;a<n.length;a++){var i,o=n[a];if(tsml.debug&&console.log("setMapMarkers() location",o),o.url&&o.formatted_address&&!o.approximate&&(i='<h3 class="notranslate">'+formatLink(o.url,o.name,"post_type")+'</h3><address class="notranslate">'+formatAddress(o.formatted_address)+"</address>",o.directions&&o.directions_url&&(i+='<a href="'+o.directions_url+'" class="btn btn-default btn-block"><svg class="icon" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M9.896 2.396a.5.5 0 0 0 0 .708l2.647 2.646-2.647 2.646a.5.5 0 1 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708 0z"/><path fill-rule="evenodd" d="M13.25 5.75a.5.5 0 0 0-.5-.5h-6.5a2.5 2.5 0 0 0-2.5 2.5v5.5a.5.5 0 0 0 1 0v-5.5a1.5 1.5 0 0 1 1.5-1.5h6.5a.5.5 0 0 0 .5-.5z"/></svg>'+o.directions+"</a>"),o.meetings&&o.meetings.length)){for(var s=null,r=0;r<o.meetings.length;r++){var l=o.meetings[r];s!=l.day&&(s&&(i+="</dl>"),s=l.day,void 0!==tsml.days[s]&&(i+="<h5>"+tsml.days[s]+"</h5>"),i+="<dl>"),i+="<dt>"+l.time+"</dt><dd>"+formatLink(l.url,l.name,"post_type")+"</dd>"}i+="</dl>"}var c={lat:parseFloat(o.latitude),lng:parseFloat(o.longitude)},d=setMapMarker(o.name,c,i);"object"==typeof d&&d&&((!bounds.north||c.lat>bounds.north)&&(bounds.north=c.lat),(!bounds.south||c.lat<bounds.south)&&(bounds.south=c.lat),(!bounds.east||c.lng>bounds.east)&&(bounds.east=c.lng),(!bounds.west||c.lng<bounds.west)&&(bounds.west=c.lng),"yes"===o.approximate&&d.remove()),tsml.debug&&console.log("setMapMarkers() marker",d),markers.push(d)}setMapBounds()}function setSearchMarker(e){if(removeSearchMarker(),e&&e.latitude){var t=document.createElement("div");t.className="marker",t.style.backgroundImage="url(data:image/svg+xml;base64,"+searchIcon+")",t.style.width="26px",t.style.height="38.4px";var a=L.divIcon({className:"marker",html:t,iconAnchor:[13,38.4],popupAnchor:[0,-22]});marker=new L.marker([e.latitude,e.longitude],{icon:a}).addTo(tsmlmap)}}jQuery((function(e){var t=e("body"),n=!1;if("object"!=typeof tsml_map){m();var i=e("#meetings #search input[name=query]");i.length&&i.val().length&&e("#tsml td").not(".time").mark(i.val());var o=e("#search li.active a").attr("data-id");"search"==o?(g(),e('a.toggle-view[data-id="map"]').hasClass("active")&&createMap(!0,locations)):("location"==o&&i.val().length||"me"==o)&&s()}else{tsml.debug&&console.log("public tsml_map",tsml_map);void 0===tsml_map.location_url?tsml_map.location:formatLink(tsml_map.location_url,tsml_map.location,"tsml_meeting");locations={},locations[tsml_map.location_id]={latitude:tsml_map.latitude,longitude:tsml_map.longitude,formatted_address:tsml_map.formatted_address,approximate:tsml_map.approximate,name:tsml_map.location,meetings:[],directions:tsml_map.directions,directions_url:tsml_map.directions_url,url:tsml_map.location_url},createMap(!1,locations)}function s(){var t=[];const a=[];e("#type li.active a").each((function(){let n=e(this).attr("data-id");n&&(-1!==["active","in_person","hybrid","online","inactive"].indexOf(n)?a.push(n):t.push(n))}));var o={action:"meetings",query:e("#meetings #search input[name=query]").val().trim(),mode:e("#search li.active a").attr("data-id"),region:e("#region li.region.active a").attr("data-id"),district:e("#region li.district.active a").attr("data-id"),day:e("#day li.active a").attr("data-id"),time:e("#time li.active a").attr("data-id"),type:t.length?t.join(","):void 0,distance:e("#distance li.active a").attr("data-id"),view:e("#meetings .toggle-view.active").attr("data-id"),attendance_option:a.length?a.join(","):void 0};tsml.debug&&console.log("doSearch() controls",o),searchLocation=null;var s={};if(s["tsml-day"]=o.day?o.day:"any","search"!=o.mode&&o.distance!=tsml.defaults.distance&&(s["tsml-distance"]=o.distance),o.mode&&o.mode!=tsml.defaults.mode&&(s["tsml-mode"]=o.mode),o.query&&o.query!=tsml.defaults.query&&(s["tsml-query"]=o.query),"search"==o.mode&&(o.region!=tsml.defaults.region?s["tsml-region"]=o.region:o.district!=tsml.defaults.district&&(s["tsml-district"]=o.district)),o.time&&o.time!=tsml.defaults.time&&(s["tsml-time"]=o.time),o.type&&o.type!=tsml.defaults.type&&(s["tsml-type"]=o.type),o.view&&o.view!=tsml.defaults.view&&(s["tsml-view"]=o.view),null!=o.attendance_option&&(s["tsml-attendance_option"]=o.attendance_option),s=e.param(s),history.pushState){var l=window.location.protocol+"//"+window.location.host+window.location.pathname;s.length&&(l=l+"?"+s),location.search.indexOf("post_type=tsml_meeting")>-1&&(l=l+(l.indexOf("?")>-1?"&":"?")+"post_type=tsml_meeting"),window.history.pushState({path:l},"",l)}e("#meetings").attr("data-mode",o.mode),"search"==o.mode?(g(),removeSearchMarker(),r(o)):"location"==o.mode?(!function(){if(!n)return;n=!1,e('#meetings #search input[name="query"]').autocomplete("destroy")}(),o.query?(e("#search button i").removeClass().addClass("glyphicon glyphicon-refresh spinning"),e.getJSON(tsml.ajaxurl,{action:"tsml_geocode",address:o.query,nonce:tsml.nonce},(function(t){tsml.debug&&console.log("doSearch() location geocoded",t),e("#search button i").removeClass().addClass("glyphicon glyphicon-map-marker"),"error"==t.status?(removeSearchMarker(),u("loc_error")):(i.val(t.formatted_address),o.latitude=t.latitude,o.longitude=t.longitude,o.query="",searchLocation={latitude:o.latitude,longitude:o.longitude},r(o))}))):u("loc_empty")):"me"==o.mode&&(o.query&&(e("#meetings #search input[name=query]").val(""),o.query=""),e("#search button i").removeClass().addClass("glyphicon glyphicon-refresh spinning"),navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){e("#search button i").removeClass().addClass("glyphicon glyphicon-user"),o.latitude=t.coords.latitude,o.longitude=t.coords.longitude,searchLocation={latitude:o.latitude,longitude:o.longitude},r(o)}),(function(){tsml.debug&&console.log("doSearch() didnt get location"),e("#search button i").removeClass().addClass("glyphicon glyphicon-user"),removeSearchMarker(),u("geo_error")}),{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e5}):(tsml.debug&&console.log("doSearch() no browser support for geo"),e("#search button i").removeClass().addClass("glyphicon glyphicon-user"),removeSearchMarker(),u("geo_error_browser")))}function r(t){for(var a in t.distance_units=tsml.distance_units,t.nonce=tsml.nonce,t)null!==t[a]&&void 0!==t[a]&&t[a].toString().length||delete t[a];tsml.debug&&console.log("getMeetings()",tsml.ajaxurl+"?"+e.param(t)),e.post(tsml.ajaxurl,t,(function(a){if(tsml.debug&&console.log("getMeetings() received",a),"object"!=typeof a||null==a)e("#meetings").addClass("empty"),u("data_error");else if(a.length){e("#meetings").removeClass("empty"),u(),locations=[];var n=e("#meetings_tbody").html("");e.each(a,(function(e,a){a.types||(a.types=[]);var i=[];if("object"==typeof tsml.flags){-1!==a.types.indexOf("TC")&&a.types.indexOf("ONL");for(var o=0;o<tsml.flags.length;o++){tsml.flags[o];-1!==a.types.indexOf(tsml.flags[o])&&"TC"!=tsml.flags[o]&&"ONL"!=tsml.flags[o]&&i.push(tsml.types[tsml.flags[o]])}}var s=[];for(o=0;o<a.types.length;o++)s.push(tsml.types[a.types[o]]);s.sort(),s=s.join(", "),locations[a.location_id]||(locations[a.location_id]={name:a.location,formatted_address:a.formatted_address,latitude:a.latitude,longitude:a.longitude,url:a.location_url,meetings:[]}),locations[a.location_id].meetings[locations[a.location_id].meetings.length]={name:a.name,time:a.time_formatted,day:a.day,notes:a.notes,url:a.url};var r=[];a.notes&&a.notes.length&&r.push("notes");for(o=0;o<a.types.length;o++)r.push("type-"+c(a.types[o]));r.push("attendance-"+a.attendance_option);var u='<tr class="'+r.join(" ")+'">';for(o=0;o<tsml.columns.length;o++)switch(tsml.columns[o]){case"time":var p=(void 0===a.day?7:a.day)+"-"+("00:00"==a.time?"23:59":a.time);u+='<td class="time" data-sort="'+p+"-"+d(a.location)+'">'+l(a,t)+"</td>";break;case"distance":u+='<td class="distance" data-sort="'+a.distance+'">'+a.distance+" "+tsml.distance_units+"</td>";break;case"name":u+='<td class="name" data-sort="'+d(a.name)+"-"+p+'">'+formatLink(a.url,a.name,"post_type"),i.length>0&&(u+=" <small>"+i.join(", ")+"</small>"),u+="</td>";break;case"location":switch(u+='<td class="location" data-sort="'+d(a.location)+"-"+p+'">',u+='<div class="location-name notranslate">'+a.location+"</div>",u+='<div class="attendance-'+a.attendance_option+'"><small>',a.attendance_option){case"online":u+="Online";break;case"inactive":u+="Temporarily Inactive";break;case"hybrid":u+="In-person and Online"}u+="</small></div>",u+="</td>";break;case"location_group":switch(meeting_location=a.location,"online"!=a.attendance_option&&"inactive"!=a.attendance_option||(void 0!==a.group?meeting_location=a.group:meeting_location=""),u+='<td class="location" data-sort="'+d(a.location)+"-"+p+'">',u+='<div class="location-name notranslate">'+meeting_location+"</div>",u+='<div class="attendance-'+a.attendance_option+'"><small>',a.attendance_option){case"online":u+="Online";break;case"inactive":u+="Temporarily Inactive";break;case"hybrid":u+="In-person and Online"}u+="</small></div>",u+="</td>";break;case"address":u+='<td class="address notranslate" data-sort="'+d(a.formatted_address)+"-"+p+'">'+formatAddress(a.formatted_address,tsml.street_only)+"</td>";break;case"region":u+='<td class="region notranslate" data-sort="'+d(a.sub_region||a.region||"")+"-"+p+'">'+(a.sub_region||a.region||"")+"</td>";break;case"district":u+='<td class="district notranslate" data-sort="'+d(a.sub_district||a.district||"")+"-"+p+'">'+(a.sub_district||a.district||"")+"</td>";break;case"types":u+='<td class="types" data-sort="'+d(s)+"-"+p+'">'+s+"</td>"}n.append(u+"</tr>")})),p(),t.query&&"search"==t.mode&&e("#tsml td").not(".time").mark(t.query),"map"==t.view&&createMap(!0,locations,searchLocation),n.trigger("tsml_meetings_updated",{meetings:a,tbody:n})}else{if(t.query&&(void 0!==t.day||void 0!==t.region||void 0!==t.time||void 0!==t.type)||void 0!==t.attendance_option)return e("#day li").removeClass("active").first().addClass("active"),e("#time li").removeClass("active").first().addClass("active"),e("#region li").removeClass("active").first().addClass("active"),e("#type li").removeClass("active").first().addClass("active"),e("#attendance_option li").removeClass("active").first().addClass("active"),e("#day span.selected").html(e("#day li:first-child a").html()),e("#time span.selected").html(e("#time li:first-child a").html()),e("#region span.selected").html(e("#region li:first-child a").html()),e("#type span.selected").html(e("#type li:first-child a").html()),e("#attendance_option span.selected").html(e("#attendance_option li:first-child a").html()),s();e("#meetings").addClass("empty"),u("no_meetings")}}),"json")}function l(e,t){return void 0===e.time_formatted||void 0===e.day||void 0===tsml.days[e.day]?"<span>"+tsml.strings.appointment+"</span>":void 0!==t.day?"<span>"+e.time_formatted+"</span>":"<span>"+tsml.days[e.day]+"</span><span>"+e.time_formatted+"</span>"}function c(e){if(null==e)return"";e=(e=(e=e.toString()).replace(/^\s+|\s+$/g,"")).toLowerCase();for(var t="àáäâèéëêìíïîòóöôùúüûñç·/_,:;",a=0;a<28;a++)e=e.replace(new RegExp(t.charAt(a),"g"),"aaaaeeeeiiiioooouuuunc------".charAt(a));return e=e.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}function d(e){if(null==e)return"";e=e.toString(),"undefined"==typeof tsml_sanitize_data&&(tsml_sanitize_data=[[/<[^>]+>/gi,""],[/[&'"<>]+/g,""],[new RegExp("[\\/\\.    -   　\\-֊־᐀᠆‐-―⸗⸚⸺⸻⹀〜〰゠︱︲﹘﹣－]","g"),"-"],[new RegExp("[^A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢄᢇ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿯ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞿꟂ-Ᶎꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭧꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ0-9²³¹¼-¾٠-٩۰-۹߀-߉०-९০-৯৴-৹੦-੯૦-૯୦-୯୲-୷௦-௲౦-౯౸-౾೦-೯൘-൞൦-൸෦-෯๐-๙໐-໙༠-༳၀-၉႐-႙፩-፼ᛮ-ᛰ០-៩៰-៹᠐-᠙᥆-᥏᧐-᧚᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙⁰⁴-⁹₀-₉⅐-ↂↅ-↉①-⒛⓪-⓿❶-➓⳽〇〡-〩〸-〺㆒-㆕㈠-㈩㉈-㉏㉑-㉟㊀-㊉㊱-㊿꘠-꘩ꛦ-ꛯ꠰-꠵꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９̀-ͯ҃-҉֑-ׇֽֿׁׂׅׄؐ-ًؚ-ٰٟۖ-ۜ۟-۪ۤۧۨ-ܑۭܰ-݊ަ-ް߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛࣓-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣঁ-ঃ়া-ৄেৈো-্ৗৢৣ৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑੰੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୢୣஂா-ூெ-ைொ-்ௗఀ-ఄా-ౄె-ైొ-్ౕౖౢౣಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣංඃ්ා-ුූෘ-ෟෲෳัิ-ฺ็-๎ັິ-ຼ່-ໍ༹༘༙༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏႚ-ႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝᠋-᠍ᢅᢆᢩᤠ-ᤫᤰ-᤻ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼᪰-᪾ᬀ-ᬄ᬴-᭄᭫-᭳ᮀ-ᮂᮡ-ᮭ᯦-᯳ᰤ-᰷᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷹᷻-᷿⃐-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯꙯-꙲ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧꢀꢁꢴ-ꣅ꣠-꣱ꣿꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀ꧥꨩ-ꨶꩃꩌꩍꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭ﬞ︀-️︠-︯-]+","g"),""],[/\-+/g,"-"],[/^\-|\-$/g,""]]);var t=document.createElement("textarea");t.innerHTML=e,e=t.value,a=window.tsml_sanitize_data;for(var n=0;n<a.length;n++)e=e.replace(a[n][0],a[n][1]);return e.toLowerCase()}function u(t){void 0===t?e("#alert").html("").addClass("hidden"):e("#alert").html(tsml.strings[t]).removeClass("hidden")}function p(){for(var t,a=e("#meetings table thead th[data-sort]").first(),n=a.attr("class"),i=a.attr("data-sort"),o=document.getElementById("meetings_tbody"),s=[],r=e("#meetings table thead th").index(a),l=0,c=o.rows.length;l<c;l++){var d=o.rows[l],u=d.cells[r].getAttribute("data-sort");"distance"==n&&(u=parseFloat(u)),s.push([u,d])}if("distance"===n)t=function([e],[t]){return"asc"===i?e-t:t-e};else if(window.Intl){var p=[document.documentElement.lang];"en"==p[0].startsWith&&p.push("en");var m=new Intl.Collator(p,{sensitivity:"variant"});t=function(e,t){return m.compare(e[0],t[0])*("asc"==i?1:-1)}}else t=function(e,t){return e[0]>t[0]?"asc"==i?1:-1:e[0]<t[0]?"asc"==i?-1:1:0};s.sort(t);for(l=0,c=s.length;l<c;l++)o.appendChild(s[l][1])}function m(){var t=(new Date).getDay(),a=e("#day li.active a").first().attr("data-id"),n=e("#time li.active a").first().attr("data-id");t!=a?(e("#time li.upcoming").addClass("hidden"),"upcoming"==n&&(e("#time li.active").removeClass("active"),e("#time li").first().addClass("active"),e("#time span.selected").html(e("#time li a").first().text()))):e("#time li.upcoming").removeClass("hidden")}function h(e,t){"function"==typeof ga&&(tsml.debug&&console.log("trackAnalytics() sending "+e+": "+t+" to google analytics"),ga("send","event","12 Step Meeting List",e,t))}function g(){n||(tsml.debug&&console.log("typeaheadEnable()"),e.getJSON(tsml.ajaxurl+"?action=tsml_typeahead").done((function(t){n=!0,e('#meetings #search input[name="query"]').autocomplete({autoFocus:!1,source:t,minLength:1,select:function(t,a){const{item:n}=a;if(tsml.debug&&console.log("item: ",n),"region"==n.type){e("#region li").removeClass("active");var i=e('#region li a[data-id="'+n.id+'"]');i.parent().addClass("active"),tsml.debug&&console.log("Active: ",i),e("#region span.selected").html(i.html()),e('#search input[name="query"]').val(""),t.preventDefault(),h("region",i.text()),s()}else"location"==n.type?(h("location",n.value),location.href=n.url):"group"==n.type&&(h("group",n.value),s())}})})))}function f(e,t,a){a||(a=window.location.href);var n,i=new RegExp("([?&])"+e+"=.*?(&|#|$)(.*)","gi");if(i.test(a))return null!=t?a.replace(i,"$1"+e+"="+t+"$2$3"):(n=a.split("#"),a=n[0].replace(i,"$1$3").replace(/(&|\?)$/,""),void 0!==n[1]&&null!==n[1]&&(a+="#"+n[1]),a);if(null!=t){var o=-1!==a.indexOf("?")?"&":"?";return n=a.split("#"),a=n[0]+o+e+"="+t,void 0!==n[1]&&null!==n[1]&&(a+="#"+n[1]),a}return a}t.on("click","a.tsml-directions",(function(t){t.preventDefault();var a=[e(this).attr("data-latitude"),e(this).attr("data-longitude")].join();["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document?window.open("maps://?daddr="+a):window.open("https://www.google.com/maps/dir/?api=1&destination="+a)})),e(".panel-expandable").on("click",".panel-heading",(function(t){e(this).closest(".panel-expandable").toggleClass("expanded"),tsml.debug&&console.log(".panel-expandable toggling")})),e("#meeting #feedback").validate({onfocusout:!1,onkeyup:function(e){},highlight:function(t,a,n){e(t).parent().addClass("has-error")},unhighlight:function(t,a,n){e(t).parent().removeClass("has-error")},errorPlacement:function(e,t){},submitHandler:function(t){var a=e(t),n=a.closest("#feedback");return a.hasClass("running"),e.post(tsml.ajaxurl,a.serialize(),(function(e){a.removeClass("running"),n.find(".list-group").html('<li class="list-group-item has-info">'+e+"</li>")})).fail((function(e){a.removeClass("running"),n.find(".list-group").html('<li class="list-group-item has-error">'+tsml.strings.email_not_sent+"</li>")})),a.addClass("running"),!1}}),e("#meetings table thead").on("click","th",(function(){var t,a=e(this).attr("class");t=e(this).attr("data-sort")&&"asc"==e(this).attr("data-sort")?"desc":"asc",e("#meetings table thead th").removeAttr("data-sort"),e("#meetings table thead th."+a).attr("data-sort",t),p()})),e("#meetings .controls").on("submit","#search",(function(){return h("search",i.val()),s(),!1})).on("click","div.expand",(function(t){t.preventDefault(),t.stopPropagation(),e(this).next("ul.children").toggleClass("expanded"),e(this).toggleClass("expanded")})).on("click",".dropdown-menu a",(function(t){t.preventDefault();var a=e(this).closest("div").attr("id");if("mode"==a)tsml.debug&&console.log("dropdown click search mode"),e("#mode li").removeClass("active"),e("#meetings").addClass("empty"),"search"==e(this).attr("data-id")?(i.prop("disabled",!1),e("#search button i").removeClass().addClass("glyphicon glyphicon-search")):"location"==e(this).attr("data-id")?(i.prop("disabled",!1),e("#search button i").removeClass().addClass("glyphicon glyphicon-map-marker"),u("loc_thinking")):"me"==e(this).attr("data-id")&&(i.prop("disabled",!0),e("#search button i").removeClass().addClass("glyphicon glyphicon-user"),u("geo_thinking")),i.attr("placeholder",e(this).text());else if("distance"==a)tsml.debug&&console.log("dropdown click distance"),e("#distance li").removeClass("active"),e("#distance span.selected").html(e(this).html()),h("distance",e(this).text());else if("region"==a){if(e(this).hasClass("switch")){tsml.debug&&console.log("dropdown click switching between region and district");var n=e(this).parent().hasClass("region")?"district":"region";return e(this).closest("#meetings").attr("tax-mode",n),void t.stopPropagation()}tsml.debug&&console.log("dropdown click region or district"),e("#region li").removeClass("active"),e("#region span.selected").html(e(this).html()),h("region",e(this).text())}else"day"==a?(tsml.debug&&console.log("dropdown click day"),e("#day li").removeClass("active"),e("#day span.selected").html(e(this).html()),h("day",e(this).text())):"time"==a?(tsml.debug&&console.log("dropdown click time"),e("#time li").removeClass("active"),e("#time span.selected").html(e(this).html()),h("time",e(this).text())):"type"==a&&(tsml.debug&&console.log("dropdown click type"),t.metaKey||e("#type li").removeClass("active"),h("type",e(this).text()));if(e(this).parent().toggleClass("active"),"type"==a)if(e("#type li.active a[data-id]").length){tsml.debug&&console.log("dropdown click "+e("#type li.active a[data-id]").length+" types selected");var o=[];e("#type li.active a[data-id]").each((function(){o.push(e(this).text())})),e("#type span.selected").html(o.join(" + "))}else tsml.debug&&console.log("dropdown click no types selected"),e("#type span.selected").html(e(this).text());var r="";e("#meetings #day li.active").index()&&(r+=e("#meetings #day span.selected").text()),e("#meetings #time li.active").index()&&(r+=" "+e("#meetings #time span.selected").text()),e("#meetings #type li.active").index()&&(r+=" "+e("#meetings #type span.selected").text()),r+=" "+tsml.program+" Meetings",e("#meetings #region li.active").index()&&(r+=" in "+e("#meetings #region span.selected").text()),document.title=r,e("#tsml #meetings .title h1").text(r),tsml.debug&&console.log("Page title: ",document.title),m(),s()})),e("#meetings #action .toggle-view").click((function(t){t.preventDefault();var a=e(this).attr("data-id");if(a!=e("#meetings").attr("data-view")&&(e("#meetings #action .toggle-view").toggleClass("active"),e("#meetings").attr("data-view",a),"map"==a&&createMap(!0,locations,searchLocation),history.pushState)){if(a==tsml.defaults.view)var n=f("tsml-view");else n=f("tsml-view",a);window.history.pushState({path:n},"",n)}})),e(window).resize((function(a){if(e("#meetings").hasClass("tsml_fullscreen")){var n=map.getCenter(),i=e(window).height()-79;t.hasClass("admin-bar")&&(i-=32),e("#map").css("height",i),google.maps.event.trigger(map,"resize"),map.setCenter(n)}})),e.widget("custom.autocomplete",e.ui.autocomplete,{_create:function(){this._super(),this.widget().menu("option","items","> :not(.ui-autocomplete-category)")},_renderItem:function(t,a){var n=new RegExp(e.ui.autocomplete.escapeRegex(this.term),"ig"),i=a.label.replace(n,"<strong>"+this.term+"</strong>");return e("<li>").attr("data-value",a.value).append(i).appendTo(t)},_renderMenu:function(t,a){var n=this,i="";e.each(a,(function(e,a){var o;if(a.type!=i){const e=`${a.type}s`;t.append("<li class='ui-autocomplete-category'>"+tsml.strings[e]+"</li>"),i=a.type}o=n._renderItemData(t,a),a.type&&o.attr("aria-label",a.type+" : "+a.value)}))}})}));
